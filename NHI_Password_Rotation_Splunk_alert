1) Recommended SPL (no logs needed)

Use this (edit secret_name and team-dl as needed):

| makeresults
| eval secret_name="svc-app-prod-secret"
| eval reminder="Annual secret renewal reminder for " . secret_name
| eval due_date=strftime(now(), "%Y-%m-%d")  // shows today; triggered yearly by cron
| table secret_name, reminder, due_date


When scheduled yearly this will send one email each year with the secret name and date.

2) Cron expressions for “once a year”

Replace HH and MM with hour and minute you want in IST (Asia/Kolkata). Splunk runs cron in the server timezone — if your Splunk server is in UTC, see conversions below.

Every year on Jan 1 at 10:00 IST

0 10 1 1 *


Every year on July 1 at 09:30 IST

30 9 1 7 *


Every year on a specific day/month — template

MM HH DD MM *


Example: Every year on November 17 at 09:00 IST

0 9 17 11 *

3) Timezone note (important)

Your timezone: Asia/Kolkata (IST = UTC+5:30).

If Splunk server timezone = IST, use the cron above directly.

If Splunk server timezone = UTC, convert IST → UTC by subtracting 5h30.

Example: 09:00 IST = 03:30 UTC → cron (UTC server) for Nov 17 at 09:00 IST:

30 3 17 11 *

4) How to create the alert in Splunk (step-by-step)

Open Search & Reporting.

Paste the SPL from section (1).

Click Save → Save As → Alert.

Settings:

Title: Annual Secret Renewal: svc-app-prod-secret

Alert Type: Scheduled

Cron schedule: Paste one of the cron expressions above (use the one matching your desired day/time).

Trigger condition: Number of results > 0

Actions → Send email:

To: team-security-dl@company.com (replace with your DL)

Subject: [Reminder] Annual secret renewal - $result.secret_name$

Body:

Reminder: Annual renewal for secret: $result.secret_name$
Due date (triggered on): $result.due_date$
Please rotate/renew as per policy.


Include results table: ON

Save the alert.

5) Extra options

If you want the alert to run on the same calendar date each year but show next year’s due date in the email, use this SPL instead:

| makeresults
| eval secret_name="svc-app-prod-secret"
| eval reminder="Annual secret renewal for " . secret_name
| eval due_date=strftime(relative_time(now(), "+365d"), "%Y-%m-%d")
| table secret_name, reminder, due_date
